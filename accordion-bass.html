<imports >
    <link rel="import" href="../polymer/polymer.html">
    <link rel="import" href="../local-dom/local-dom.html" async>
    <link rel="import" href="./accordion-button.html" async>
    <link rel="import" href="../animation-behaviors/scale-up-behavior.html">
    <script src="./synth_vars.js" > </script>
</imports>
<!--

Shows drop down menu (works on chrome)

### Usage
The list displayed in the drop down menu can be set as an attribute.

    <drop-menu list-items='["first" ,"second"]'></drop-menu>

For an overlayed drop menu:

    <drop-menu overlay-menu list-items='["first" ,"second"]'></drop-menu>

### Styling
 Custom property | Description | Default
----------------|-------------|----------
`--item-background-color` | List item backround color | `#f1ecef`
`--item-color` | List item color used for fonts | `#302f31`
`--close-color` | Icon button hover color | `4775D1`
`--content-background` | Drop menu's background color | `white`
`--close-color` | Icon button hover color | `4775D1`
`--icon-button` | Mixin applied the icon button | `{}`

@demo demo/drop-menu-demo.html
-->
<dom-module id="accordion-bass">
    <template>
        <style>
            :host {}
            local-dom {
                height: 100vh;
                @apply(--layout-horizontal);
                @apply(--layout-center);
                @apply(--layout-justified);
            }
            #col {
                padding: 1.3vw;
                height: 51vh;
                @apply(--layout-vertical);
                @apply(--layout-justified);
            }
            [mobile] #col {
                padding: 1.8vw;
            }
            [tablet] #col {
                padding: 1.2vw;
            }
        </style>
        <!-- local DOM -->
        <local-dom mobile="{{mobile}}" tablet="{{tablet}}" laptop="{{laptop}}">
            <div id="col">
                <accordion-button  close-index="{{chordsCloseIndex.0}}" open-index="{{chordsOpenIndex.0}}" text="s3" state="[[stateChords3]]" button-type="bass_chord" instrument-url="[[instrumentChordsUrl]]" ></accordion-button>
                <accordion-button close-index="{{closeIndex.0}}" open-index="{{openIndex.0}}" text="3" button-type="bass_note" state="[[state3]]" instrument-url="[[instrumentUrl]]" ></accordion-button>
                <accordion-button close-index="{{chordsCloseIndex.1}}" open-index="{{chordsOpenIndex.1}}" text="s4" state="[[stateChords4]]" button-type="bass_chord" instrument-url="[[instrumentChordsUrl]]" ></accordion-button>
                <accordion-button close-index="{{closeIndex.1}}" open-index="{{openIndex.1}}" text="4" button-type="bass_note" state="[[state4]]" instrument-url="[[instrumentUrl]]" ></accordion-button>
                <accordion-button close-index="{{chordsCloseIndex.2}}" open-index="{{chordsOpenIndex.2}}" text="s5" state="[[stateChords5]]" button-type="bass_chord" instrument-url="[[instrumentChordsUrl]]" ></accordion-button>
                <accordion-button close-index="{{closeIndex.2}}" open-index="{{openIndex.2}}" text="5" button-type="bass_note" state="[[state5]]" instrument-url="[[instrumentUrl]]" ></accordion-button>
            </div>
            <div id="col">
                <accordion-button close-index="{{chordsCloseIndex.3}}" open-index="{{chordsOpenIndex.3}}" text="s0" state="[[stateChords0]]" button-type="bass_chord" instrument-url="[[instrumentChordsUrl]]" ></accordion-button>
                <accordion-button close-index="{{closeIndex.3}}" open-index="{{openIndex.3}}" text="0" button-type="bass_note" state="[[state0]]" instrument-url="[[instrumentUrl]]" ></accordion-button>
                <accordion-button close-index="{{chordsCloseIndex.4}}" open-index="{{chordsOpenIndex.4}}" text="s1" state="[[stateChords1]]" button-type="bass_chord" instrument-url="[[instrumentChordsUrl]]" ></accordion-button>
                <accordion-button close-index="{{closeIndex.4}}" open-index="{{openIndex.4}}" text="1" button-type="bass_note" state="[[state1]]" instrument-url="[[instrumentUrl]]" ></accordion-button>
                <accordion-button close-index="{{chordsCloseIndex.5}}" open-index="{{chordsOpenIndex.5}}" text="s2" state="[[stateChords2]]" button-type="bass_chord" instrument-url="[[instrumentChordsUrl]]" ></accordion-button>
                <accordion-button close-index="{{closeIndex.5}}" open-index="{{openIndex.5}}" text="2" button-type="bass_note" state="[[state2]]" instrument-url="[[instrumentUrl]]" ></accordion-button>
            </div>
        </local-dom>
    </template>
    <script>
        Polymer({
            is: "accordion-bass",
            observers: ['_swap(showingTreble)'],
            behaviors: [ScaleUpBehavior],
            listeners: {
                'click':'_test'
            },
            properties: {
                chordsCloseIndex:{
                    type:Array,
                    value:[]
                },
                chordsOpenIndex:{
                    type:Array,
                    value:[]
                },
                closeIndex:{
                    type:Array,
                    value:[]
                },
                openIndex:{
                    type:Array,
                    value:[]
                },
                instrumentUrl:{
                    type:String
                },
                instrumentChordsUrl:{
                    type:String
                },
                state0: {
                    type: Number,
                    value: 0
                },
                state1: {
                    type: Number,
                    value: 0
                },
                state2: {
                    type: Number,
                    value: 0
                },
                state3: {
                    type: Number,
                    value: 0
                },
                state4: {
                    type: Number,
                    value: 0
                },
                state5: {
                    type: Number,
                    value: 0
                },
                stateChords0: {
                    type: Number,
                    value: 0
                },
                stateChords1: {
                    type: Number,
                    value: 0
                },
                stateChords2: {
                    type: Number,
                    value: 0
                },
                stateChords3: {
                    type: Number,
                    value: 0
                },
                stateChords4: {
                    type: Number,
                    value: 0
                },
                stateChords5: {
                    type: Number,
                    value: 0
                }
            },
            _test: function(){
                this.changePitch(3) ;
            },
            changePitch: function(pitch){
                if (pitch ===0) {
                    this._updateIndexes() ;
                    return ;
                }
                for ( var i = 0 ;i < 42 ; i ++ ){
                    this.chordsCloseIndex[i] = bassChordsNextNote[this.chordsCloseIndex[i]]  ;
                    this.chordsOpenIndex[i] = bassChordsNextNote[this.chordsOpenIndex[i]] ;
                }
                this.changePitch(pitch-1) ;
            },
            _swap: function (showingTreble) {
                if (!showingTreble) {
                    this.playAnimation('entry');
                }
            },
            buttonPress: function (button) {
                var which = Math.floor(button / 2);
                switch (which) {
                    case 0:
                        this.state0 = (button % 2) + 1;
                        return;
                    case 1:
                        this.state1 = (button % 2) + 1;
                        return;
                    case 2:
                        this.state2 = (button % 2) + 1;
                        return;
                    case 3:
                        this.state3 = (button % 2) + 1;
                        return;
                    case 4:
                        this.state4 = (button % 2) + 1;
                        return;
                    case 5:
                        this.state5 = (button % 2) + 1;
                        return;
                }
            },
            buttonRelease: function (button) {
                var which = Math.floor(button / 2);
                switch (which) {
                    case 0:
                        this.state0 = 0;
                        return;
                    case 1:
                        this.state1 = 0;
                        return;
                    case 2:
                        this.state2 = 0;
                        return;
                    case 3:
                        this.state3 = 0;
                        return;
                    case 4:
                        this.state4 = 0;
                        return;
                    case 5:
                        this.state5 = 0;
                        return;
                }
            },
            chordButtonPress: function (button) {
                var which = Math.floor(button / 2);
                switch (which) {
                    case 0:
                        this.stateChords0 = (button % 2) + 1;
                        return;
                    case 1:
                        this.stateChords1 = (button % 2) + 1;
                        return;
                    case 2:
                        this.stateChords2 = (button % 2) + 1;
                        return;
                    case 3:
                        this.stateChords3 = (button % 2) + 1;
                        return;
                    case 4:
                        this.stateChords4 = (button % 2) + 1;
                        return;
                    case 5:
                        this.stateChords5 = (button % 2) + 1;
                        return;
                }
            },
            chordButtonRelease: function (button) {
                var which = Math.floor(button / 2);
                switch (which) {
                    case 0:
                        this.stateChords0 = 0;
                        return;
                    case 1:
                        this.stateChords1 = 0;
                        return;
                    case 2:
                        this.stateChords2 = 0;
                        return;
                    case 3:
                        this.stateChords3 = 0;
                        return;
                    case 4:
                        this.stateChords4 = 0;
                        return;
                    case 5:
                        this.stateChords5 = 0;
                        return;
                }
            },
            _updateIndexes: function(){
                var array = this.closeIndex ;
                this.closeIndex = [] ;
                this.closeIndex = array ;

                var array2 = this.openIndex ;
                this.openIndex = [] ;
                this.openIndex = array2 ;

                var array3 = this.chordsCloseIndex ;
                this.chordsCloseIndex = [] ;
                this.chordsCloseIndex = array3 ;

                var array4 = this.chordsOpenIndex ;
                this.chordsOpenIndex = [] ;
                this.chordsOpenIndex = array4 ;
            },
            ready: function () {
                this.instrumentUrl ="/data/accordion_synth/bass_notes" ;
                this.instrumentChordsUrl ="/data/accordion_synth/bass_chords" ;

                this.closeIndex[0]= 52 ;
                this.closeIndex[1]= 57 ;
                this.closeIndex[2]= 58 ;
                this.closeIndex[3]= 55 ;
                this.closeIndex[4]= 48 ;
                this.closeIndex[5]= 53 ;

                this.openIndex[0]= 57 ;
                this.openIndex[1]= 50 ;
                this.openIndex[2]= 58 ;
                this.openIndex[3]= 50 ;
                this.openIndex[4]= 55 ;
                this.openIndex[5]= 48 ;

                this.chordsCloseIndex[0] = 41 ;
                this.chordsCloseIndex[1] = 5 ;
                this.chordsCloseIndex[2] = 9 ;
                this.chordsCloseIndex[3] = 35 ;
                this.chordsCloseIndex[4] = 15;
                this.chordsCloseIndex[5] = 22 ;

                this.chordsOpenIndex[0] = 3;
                this.chordsOpenIndex[1] = 24 ;
                this.chordsOpenIndex[2] = 9 ;
                this.chordsOpenIndex[3] = 26 ;
                this.chordsOpenIndex[4] = 35 ;
                this.chordsOpenIndex[5] = 15 ;

                this._updateIndexes() ;
            }
        });
    </script>
</dom-module>
