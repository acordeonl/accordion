<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../local-dom/local-dom.html" async>
<link rel="import" href="../animation-behaviors/scale-up-behavior.html">
<link rel="import" href="./accordion-button.html" async>
<!--

Shows drop down menu (works on chrome)

### Usage
The list displayed in the drop down menu can be set as an attribute.

    <drop-menu list-items='["first" ,"second"]'></drop-menu>

For an overlayed drop menu:

    <drop-menu overlay-menu list-items='["first" ,"second"]'></drop-menu>

### Styling
 Custom property | Description | Default
----------------|-------------|----------
`--item-background-color` | List item backround color | `#f1ecef`
`--item-color` | List item color used for fonts | `#302f31`
`--close-color` | Icon button hover color | `4775D1`
`--content-background` | Drop menu's background color | `white`
`--close-color` | Icon button hover color | `4775D1`
`--icon-button` | Mixin applied the icon button | `{}`

@demo demo/drop-menu-demo.html
-->
<dom-module id="accordion-treble">
    <template>
        <style>
            :host {}
            local-dom {
                height: 100vh;
                @apply(--layout-center);
                @apply(--layout-justified);
            }
            .col1 {
                height: 82vh;
                /*@apply(--layout-vertical);*/
                @apply(--layout-justified);
            }
            .col2 {
                height: 92vh;
                padding: 0;
                /*margin-left: -0.3vh;
                margin-right: -0.3vh;*/
                /*@apply(--layout-vertical);*/
                @apply(--layout-justified);
            }
            [mobile] #col2 {
                padding: 0.8vw;
            }
            [tablet] #col2 {
                padding: 0.6vw;
            }
            .vertical{
                @apply(--layout-vertical);
            }
            .reversedVertical{
                @apply(--layout-vertical-reverse);
            }
            .reversedHorizontal{
                @apply(--layout-horizontal-reverse);
            }
            .horizontal{
                @apply(--layout-horizontal);
            }
        </style>
        <!-- local DOM -->
        <local-dom  class$="{{_computeRotation(rotation)}}" mobile="{{mobile}}" tablet="{{tablet}}" laptop="{{laptop}}">
            <div class$="col1 {{_computeColRotation(rotation)}}">
                <accordion-button id21 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.21]]" open-index="[[openIndex.21]]" button-type="treble" state="[[state21]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id22 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.22]]" open-index="[[openIndex.22]]" button-type="treble" state="[[state22]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id23 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.23]]" open-index="[[openIndex.23]]" button-type="treble" state="[[state23]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id24 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.24]]" open-index="[[openIndex.24]]" button-type="treble" state="[[state24]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id25 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.25]]" open-index="[[openIndex.25]]" button-type="treble" state="[[state25]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id26 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.26]]" open-index="[[openIndex.26]]" button-type="treble" state="[[state26]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id27 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.27]]" open-index="[[openIndex.27]]" button-type="treble" state="[[state27]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id28 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.28]]" open-index="[[openIndex.28]]" button-type="treble" state="[[state28]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id29 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.29]]" open-index="[[openIndex.29]]" button-type="treble" state="[[state29]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id30 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="[[closeIndex.30]]" open-index="[[openIndex.30]]" button-type="treble" state="[[state30]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
            </div>
            <div class$="col2 {{_computeColRotation(rotation)}}">
                <accordion-button id10 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.10}}" open-index="{{openIndex.10}}" button-type="treble" state="[[state10]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id11 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.11}}" open-index="{{openIndex.11}}" button-type="treble" state="[[state11]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id12 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.12}}" open-index="{{openIndex.12}}" button-type="treble" state="[[state12]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id13 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.13}}" open-index="{{openIndex.13}}" button-type="treble" state="[[state13]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id14 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.14}}" open-index="{{openIndex.14}}" button-type="treble" state="[[state14]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id15 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.15}}" open-index="{{openIndex.15}}" button-type="treble" state="[[state15]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id16 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.16}}" open-index="{{openIndex.16}}" button-type="treble" state="[[state16]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id17 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.17}}" open-index="{{openIndex.17}}" button-type="treble" state="[[state17]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id18 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.18}}" open-index="{{openIndex.18}}" button-type="treble" state="[[state18]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id19 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.19}}" open-index="{{openIndex.19}}" button-type="treble" state="[[state19]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id20 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.20}}" open-index="{{openIndex.20}}" button-type="treble" state="[[state20]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
            </div>
            <div class$="col1 {{_computeColRotation(rotation)}}">
                <accordion-button id0 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.0}}" open-index="{{openIndex.0}}" button-type="treble" state="[[state0]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id1 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.1}}" open-index="{{openIndex.1}}" button-type="treble" state="[[state1]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id2 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.2}}" open-index="{{openIndex.2}}" button-type="treble" state="[[state2]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id3 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.3}}" open-index="{{openIndex.3}}" button-type="treble" state="[[state3]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id4 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.4}}" open-index="{{openIndex.4}}" button-type="treble" state="[[state4]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id5 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.5}}" open-index="{{openIndex.5}}" button-type="treble" state="[[state5]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id6 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.6}}" open-index="{{openIndex.6}}" button-type="treble" state="[[state6]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id7 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.7}}" open-index="{{openIndex.7}}" button-type="treble" state="[[state7]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id8 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.8}}" open-index="{{openIndex.8}}" button-type="treble" state="[[state8]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
                <accordion-button id9 button-velocity="[[buttonVelocity]]" button-volume="[[volume]]" close-index="{{closeIndex.9}}" open-index="{{openIndex.9}}" button-type="treble" state="[[state9]]" instrument-url="[[instrumentUrl]]" showing-notes="[[showingNotes]]"></accordion-button>
            </div>
        </local-dom>
    </template>
    <script>
        Polymer({
            is: "accordion-treble",
            observers: ['_swap(showingTreble)'],
            behaviors: [ScaleUpBehavior],
            listeners: {
                'click':'_test'
            },
            properties: {
                buttonVelocity:{
                    type:Number
                },
                volume:{
                    type:Number,
                    value:100
                },
                col1:{
                    type:String,
                    value:"col1"
                },
                col2:{
                    type:String,
                    value:"col2"
                },
                rotation:{
                    type:Boolean,
                    value:false
                },
                showingNotes:{
                    type:Boolean,
                    value:false
                },
                tone:{
                    type:Number,
                    value:0
                },
                changingPitch:{
                    type:Boolean,
                    value:false
                },
                closeIndex: {
                    type: Array,
                    value: []
                },
                openIndex: {
                    type: Array,
                    value: []
                },
                instrumentUrl: {
                    type: String
                },
                state0: {
                    type: Number,
                    value: 0
                },
                state1: {
                    type: Number,
                    value: 0
                },
                state2: {
                    type: Number,
                    value: 0
                },
                state3: {
                    type: Number,
                    value: 0
                },
                state4: {
                    type: Number,
                    value: 0
                },
                state5: {
                    type: Number,
                    value: 0
                },
                state6: {
                    type: Number,
                    value: 0
                },
                state7: {
                    type: Number,
                    value: 0
                },
                state8: {
                    type: Number,
                    value: 0
                },
                state9: {
                    type: Number,
                    value: 0
                },
                state10: {
                    type: Number,
                    value: 0
                },
                state11: {
                    type: Number,
                    value: 0
                },
                state12: {
                    type: Number,
                    value: 0
                },
                state13: {
                    type: Number,
                    value: 0
                },
                state14: {
                    type: Number,
                    value: 0
                },
                state15: {
                    type: Number,
                    value: 0
                },
                state16: {
                    type: Number,
                    value: 0
                },
                state17: {
                    type: Number,
                    value: 0
                },
                state18: {
                    type: Number,
                    value: 0
                },
                state19: {
                    type: Number,
                    value: 0
                },
                state20: {
                    type: Number,
                    value: 0
                },
                state21: {
                    type: Number,
                    value: 0
                },
                state22: {
                    type: Number,
                    value: 0
                },
                state23: {
                    type: Number,
                    value: 0
                },
                state24: {
                    type: Number,
                    value: 0
                },
                state25: {
                    type: Number,
                    value: 0
                },
                state26: {
                    type: Number,
                    value: 0
                },
                state27: {
                    type: Number,
                    value: 0
                },
                state28: {
                    type: Number,
                    value: 0
                },
                state29: {
                    type: Number,
                    value: 0
                },
                state30: {
                    type: Number,
                    value: 0
                }
            },
            _test: function(){
                this._startButtonAudio(4,0) ;
                this._stopButtonAudio(4,1) ;
            },
            _onload: function(request){
                request = request.currentTarget ;
                if (request.status === 404) {
                    if (!errorLoading) {
                        this.fire("toast", {msg: 'La tonalidad no pudo ser cargada'});
                        errorLoading = true;
                    }
                    return;
                }
                var data = request.response;
                var bb = new DataView(data);
                var arr = request.responseURL.split("/");
                var note =  arr[arr.length-1].split("c.")[0] ;
                loopDurations[note] = bb.getFloat32(0, true);
                var length = bb.getUint32(4, true);
                var dstU8 = new Uint8Array(length);
                var srcU8 = new Uint8Array(data, 8, length);
                dstU8.set(srcU8);
                var sound = dstU8;
                context.decodeAudioData(sound.buffer, function (buffer) {
                    notesBuffers[note] = buffer ;
                });
            },
            _loadNote: function(note){
                var url = this.instrumentUrl+"/"+note+"c.mp3" ;
                request = new XMLHttpRequest();
                request.open('GET', url, true);
                request.responseType = 'arraybuffer';
                request.onload = this._onload ;
                request.send();
            },
            _loadNotes: function(){
                for (var i = 24; i < 110; i++) {
                    this._loadNote(i) ;
                }
            },
            _startButtonAudio: function(button,time){
                var source = context.createBufferSource();
                var which = Math.floor(button / 2);
                var state = (button % 2) + 1;
                var note = this.openIndex[which] ;
                if ( state === 1 )
                    note = this.closeIndex[which] ;
                source.buffer = notesBuffers[note] ;
                source.loopStart = source.buffer.duration - loopDurations[note];
                source.loopEnd = source.buffer.duration;
                sourceGain = context.createGain();
                source.connect(sourceGain);
                source.loop = true;
                sourceGain.connect(compressor);
                source.start(time);
                var audio = {} ;
                audio.source =  source ;
                audio.gain =  sourceGain ;
                trebleButtonAudio[button] = audio ;
            },
            _stopButtonAudio: function(button,time){
                var audio = trebleButtonAudio[button] ;
                audio.gain.gain.setTargetAtTime(0,time, 0.008) ;
                audio.source.stop(time+0.1) ;
            },
            addButtonAction: function(button , action){
                if(action.state === 0 ) {
                    this._stopButtonAudio(button,action.time) ;
                }
                else {
                    this._startButtonAudio(button,action.time) ;
                }
                var which = Math.floor(button / 2);
                this.$$("[id"+which+"]").addButtonAction(action) ;
            },
            update: function(){
                var nodeList = Polymer.dom(this.root).querySelectorAll('ACCORDION-BUTTON');
                for (var i = 0; i < nodeList.length; i++) {
                    nodeList[i].update() ;
                }
            },
            toggleNotes: function(){
                this.showingNotes = !this.showingNotes ;
            },
            _computeRotation: function(rotation){
                if( rotation )
                    return "reversedHorizontal" ;
                return "horizontal" ;
            },
            _computeColRotation: function(rotation){
                if( rotation )
                    return "reversedVertical" ;
                return "vertical" ;
            },
            buttonPress: function (button) {
                var which = Math.floor(button / 2);
                switch (which) {
                    case 0:
                        this.state0 = (button % 2) + 1;
                        return;
                    case 1:
                        this.state1 = (button % 2) + 1;
                        return;
                    case 2:
                        this.state2 = (button % 2) + 1;
                        return;
                    case 3:
                        this.state3 = (button % 2) + 1;
                        return;
                    case 4:
                        this.state4 = (button % 2) + 1;
                        return;
                    case 5:
                        this.state5 = (button % 2) + 1;
                        return;
                    case 6:
                        this.state6 = (button % 2) + 1;
                        return;
                    case 7:
                        this.state7 = (button % 2) + 1;
                        return;
                    case 8:
                        this.state8 = (button % 2) + 1;
                        return;
                    case 9:
                        this.state9 = (button % 2) + 1;
                        return;
                    case 10:
                        this.state10 = (button % 2) + 1;
                        return;
                    case 11:
                        this.state11 = (button % 2) + 1;
                        return;
                    case 12:
                        this.state12 = (button % 2) + 1;
                        return;
                    case 13:
                        this.state13 = (button % 2) + 1;
                        return;
                    case 14:
                        this.state14 = (button % 2) + 1;
                        return;
                    case 15:
                        this.state15 = (button % 2) + 1;
                        return;
                    case 16:
                        this.state16 = (button % 2) + 1;
                        return;
                    case 17:
                        this.state17 = (button % 2) + 1;
                        return;
                    case 18:
                        this.state18 = (button % 2) + 1;
                        return;
                    case 19:
                        this.state19 = (button % 2) + 1;
                        return;
                    case 20:
                        this.state20 = (button % 2) + 1;
                        return;
                    case 21:
                        this.state21 = (button % 2) + 1;
                        return;
                    case 22:
                        this.state22 = (button % 2) + 1;
                        return;
                    case 23:
                        this.state23 = (button % 2) + 1;
                        return;
                    case 24:
                        this.state24 = (button % 2) + 1;
                        return;
                    case 25:
                        this.state25 = (button % 2) + 1;
                        return;
                    case 26:
                        this.state26 = (button % 2) + 1;
                        return;
                    case 27:
                        this.state27 = (button % 2) + 1;
                        return;
                    case 28:
                        this.state28 = (button % 2) + 1;
                        return;
                    case 29:
                        this.state29 = (button % 2) + 1;
                        return;
                    case 30:
                        this.state30 = (button % 2) + 1;
                        return;
                }
            },
            buttonRelease: function (button) {
                var which = Math.floor(button / 2);
                switch (which) {
                    case 0:
                        this.state0 = 0;
                        return;
                    case 1:
                        this.state1 = 0;
                        return;
                    case 2:
                        this.state2 = 0;
                        return;
                    case 3:
                        this.state3 = 0;
                        return;
                    case 4:
                        this.state4 = 0;
                        return;
                    case 5:
                        this.state5 = 0;
                        return;
                    case 6:
                        this.state6 = 0;
                        return;
                    case 7:
                        this.state7 = 0;
                        return;
                    case 8:
                        this.state8 = 0;
                        return;
                    case 9:
                        this.state9 = 0;
                        return;
                    case 10:
                        this.state10 = 0;
                        return;
                    case 11:
                        this.state11 = 0;
                        return;
                    case 12:
                        this.state12 = 0;
                        return;
                    case 13:
                        this.state13 = 0;
                        return;
                    case 14:
                        this.state14 = 0;
                        return;
                    case 15:
                        this.state15 = 0;
                        return;
                    case 16:
                        this.state16 = 0;
                        return;
                    case 17:
                        this.state17 = 0;
                        return;
                    case 18:
                        this.state18 = 0;
                        return;
                    case 19:
                        this.state19 = 0;
                        return;
                    case 20:
                        this.state20 = 0;
                        return;
                    case 21:
                        this.state21 = 0;
                        return;
                    case 22:
                        this.state22 = 0;
                        return;
                    case 23:
                        this.state23 = 0;
                        return;
                    case 24:
                        this.state24 = 0;
                        return;
                    case 25:
                        this.state25 = 0;
                        return;
                    case 26:
                        this.state26 = 0;
                        return;
                    case 27:
                        this.state27 = 0;
                        return;
                    case 28:
                        this.state28 = 0;
                        return;
                    case 29:
                        this.state29 = 0;
                        return;
                    case 30:
                        this.state30 = 0;
                        return;
                }
            },
            changePitch: function (pitch) {
                for ( var i = 0 ; i < 31 ;i ++  ) {
                    this.closeIndex[i]=this.closeIndex[i]+pitch ;
                    this.openIndex[i]=this.openIndex[i]+pitch ;
                }
                this._updateIndexes() ;
            },
            _updateIndexes: function(){
                var array = this.closeIndex ;
                this.closeIndex = [] ;
                this.closeIndex = array ;

                var array2 = this.openIndex ;
                this.openIndex = [] ;
                this.openIndex = array2 ;
            },
            _swap: function (showingTreble) {
                if (showingTreble) {
                    this.playAnimation('entry');
                }
            },
            _requestBuffer: function (url, which) {
                var request = new XMLHttpRequest();
                request.open('GET', url, true);
                request.responseType = 'arraybuffer';
                request.onload = function () {
                    if (request.status === 404) {
                        if (!errorLoading) {
                            this.fire("toast", {msg: 'La tonalidad no pudo ser cargada'});
                            errorLoading = true;
                        }
                        return;
                    }
                    var data = request.response;
                    var bb = new DataView(data);
                    if (which === "close")
                        this.closeLoopDuration = bb.getFloat32(0, true);
                    else
                        this.openLoopDuration = bb.getFloat32(0, true);
                    var length = bb.getUint32(4, true);
                    var dstU8 = new Uint8Array(length);
                    var srcU8 = new Uint8Array(data, 8, length);
                    dstU8.set(srcU8);
                    var sound = dstU8;
                    context.decodeAudioData(sound.buffer, function (buffer) {
                        savedBuffers[url] = buffer;
                        if (which === "close") {
                            loopDurations[url] = this.closeLoopDuration ;
                            this.closeBuffer = buffer;
                            this._loadedCloseNote = true;
                        } else {
                            loopDurations[url] = this.openLoopDuration ;
                            this.openBuffer = buffer;
                            this._loadedOpenNote = true;
                        }
                        if (this._loadedOpenNote && this._loadedCloseNote) {
                            this.done = true;
                        }
                    }.bind(this));
                }.bind(this);
                request.send();
            },
            ready: function () {
                this.instrumentUrl = "/data/accordion_synth/treble";
                this._loadNotes() ;

                this.closeIndex[21] = 61;
                this.closeIndex[22] = 55;
                this.closeIndex[23] = 59;
                this.closeIndex[24] = 62;
                this.closeIndex[25] = 67;
                this.closeIndex[26] = 71;
                this.closeIndex[27] = 74;
                this.closeIndex[28] = 79;
                this.closeIndex[29] = 83;
                this.closeIndex[30] = 86;
                this.closeIndex[10] = 66;
                this.closeIndex[11] = 55;
                this.closeIndex[12] = 60;
                this.closeIndex[13] = 64;
                this.closeIndex[14] = 67;
                this.closeIndex[15] = 72;
                this.closeIndex[16] = 76;
                this.closeIndex[17] = 79;
                this.closeIndex[18] = 84;
                this.closeIndex[19] = 88;
                this.closeIndex[20] = 91;
                this.closeIndex[0] = 75;
                this.closeIndex[1] = 60;
                this.closeIndex[2] = 65;
                this.closeIndex[3] = 69;
                this.closeIndex[4] = 72;
                this.closeIndex[5] = 77;
                this.closeIndex[6] = 81;
                this.closeIndex[7] = 84;
                this.closeIndex[8] = 89;
                this.closeIndex[9] = 93;

                this.openIndex[21] = 63;
                this.openIndex[22] = 57;
                this.openIndex[23] = 60;
                this.openIndex[24] = 64;
                this.openIndex[25] = 66;
                this.openIndex[26] = 69;
                this.openIndex[27] = 72;
                this.openIndex[28] = 76;
                this.openIndex[29] = 78;
                this.openIndex[30] = 81;
                this.openIndex[10] = 68;
                this.openIndex[11] = 59;
                this.openIndex[12] = 62;
                this.openIndex[13] = 65;
                this.openIndex[14] = 69;
                this.openIndex[15] = 71;
                this.openIndex[16] = 74;
                this.openIndex[17] = 77;
                this.openIndex[18] = 81;
                this.openIndex[19] = 83;
                this.openIndex[20] = 86;
                this.openIndex[0] = 73;
                this.openIndex[1] = 64;
                this.openIndex[2] = 67;
                this.openIndex[3] = 70;
                this.openIndex[4] = 74;
                this.openIndex[5] = 76;
                this.openIndex[6] = 79;
                this.openIndex[7] = 82;
                this.openIndex[8] = 86;
                this.openIndex[9] = 88;
                this.changePitch(this.tone) ;
            }
        });
    </script>
</dom-module>
